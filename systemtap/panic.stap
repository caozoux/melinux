#!/usr/bin/env stap
 
%{
#include<linux/in.h>
#include<linux/ip.h>
%}

function test() %{
	unsigned long *p;
	p=0;
	*p=1;
%}

function read_iphdr:long(skb:long) %{
	struct iphdr *iph = ip_hdr((struct sk_buff*)STAP_ARG_skb);
	STAP_RETVALUE = (long)iph;
%}


probe kernel.function("account_entity_enqueue")
{
	read_iphdr(0)
}
